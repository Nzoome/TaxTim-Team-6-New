{"ast":null,"code":"/**\r\n * PDF Generator for SARS Audit Report\r\n * \r\n * This module generates a comprehensive PDF audit report suitable for SARS submission.\r\n * Uses jsPDF library for PDF generation.\r\n */\n\n// For now, we'll create a simple implementation that uses the browser's print functionality\n// In production, you'd use jsPDF or similar library\n\nexport const generatePDF = async (transactions, summary, filters) => {\n  // Create a temporary container for the report\n  const reportHTML = generateReportHTML(transactions, summary, filters);\n\n  // Create a new window for printing\n  const printWindow = window.open('', '_blank');\n  if (!printWindow) {\n    throw new Error('Popup blocked. Please allow popups for this site.');\n  }\n  printWindow.document.write(`\n    <!DOCTYPE html>\n    <html>\n    <head>\n      <title>Crypto Tax Audit Report - SARS</title>\n      <style>\n        ${getPrintStyles()}\n      </style>\n    </head>\n    <body>\n      ${reportHTML}\n    </body>\n    </html>\n  `);\n  printWindow.document.close();\n\n  // Wait for content to load, then print\n  setTimeout(() => {\n    printWindow.print();\n  }, 500);\n};\nconst generateReportHTML = (transactions, summary, filters) => {\n  const formatCurrency = amount => {\n    return new Intl.NumberFormat('en-ZA', {\n      style: 'currency',\n      currency: 'ZAR',\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2\n    }).format(amount);\n  };\n  const formatCrypto = (amount, decimals = 8) => {\n    if (amount === null || amount === undefined) return '-';\n    return parseFloat(amount).toFixed(decimals).replace(/\\.?0+$/, '');\n  };\n  const formatDate = dateString => {\n    if (!dateString) return '-';\n    const date = new Date(dateString);\n    return date.toLocaleDateString('en-ZA', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n  const currentDate = new Date().toLocaleDateString('en-ZA', {\n    year: 'numeric',\n    month: 'long',\n    day: 'numeric'\n  });\n  const filterText = [];\n  if (filters.asset !== 'all') filterText.push(`Asset: ${filters.asset}`);\n  if (filters.type !== 'all') filterText.push(`Type: ${filters.type}`);\n  if (filters.taxYear !== 'all') filterText.push(`Tax Year: ${filters.taxYear}`);\n  const filterDisplay = filterText.length > 0 ? filterText.join(', ') : 'None';\n  return `\n    <div class=\"report\">\n      <!-- Header -->\n      <div class=\"report-header\">\n        <h1>Cryptocurrency Capital Gains Tax Report</h1>\n        <h2>SARS Audit Report</h2>\n        <p class=\"report-date\">Generated: ${currentDate}</p>\n        <div class=\"divider\"></div>\n      </div>\n\n      <!-- Executive Summary -->\n      <div class=\"section\">\n        <h3>Executive Summary</h3>\n        <table class=\"summary-table\">\n          <tr>\n            <td class=\"label\">Total Capital Gains:</td>\n            <td class=\"value positive\">${formatCurrency(summary.totalCapitalGain)}</td>\n          </tr>\n          <tr>\n            <td class=\"label\">Total Capital Losses:</td>\n            <td class=\"value negative\">${formatCurrency(summary.totalCapitalLoss)}</td>\n          </tr>\n          <tr class=\"highlight\">\n            <td class=\"label\"><strong>Net Capital Gain:</strong></td>\n            <td class=\"value\"><strong>${formatCurrency(summary.netCapitalGain)}</strong></td>\n          </tr>\n          <tr class=\"highlight-primary\">\n            <td class=\"label\"><strong>Taxable Capital Gain (40% inclusion):</strong></td>\n            <td class=\"value\"><strong>${formatCurrency(summary.taxableCapitalGain)}</strong></td>\n          </tr>\n          <tr>\n            <td class=\"label\">Total Proceeds:</td>\n            <td class=\"value\">${formatCurrency(summary.totalProceeds)}</td>\n          </tr>\n          <tr>\n            <td class=\"label\">Total Cost Base (FIFO):</td>\n            <td class=\"value\">${formatCurrency(summary.totalCostBase)}</td>\n          </tr>\n          <tr>\n            <td class=\"label\">Transactions Processed:</td>\n            <td class=\"value\">${summary.transactionsProcessed}</td>\n          </tr>\n        </table>\n        \n        <div class=\"info-box\">\n          <p><strong>Applied Filters:</strong> ${filterDisplay}</p>\n          <p><strong>Method:</strong> First-In-First-Out (FIFO)</p>\n          <p><strong>Inclusion Rate:</strong> 40% for individuals (as per SARS requirements)</p>\n        </div>\n      </div>\n\n      <!-- SARS Compliance -->\n      <div class=\"section\">\n        <h3>SARS Compliance Information</h3>\n        <p>This report has been prepared in accordance with South African Revenue Service (SARS) guidelines for cryptocurrency taxation:</p>\n        <ul>\n          <li><strong>Tax Year:</strong> March 1 to February 28/29 of the following year</li>\n          <li><strong>CGT Inclusion Rate:</strong> 40% for individuals</li>\n          <li><strong>Valuation Method:</strong> FIFO (First-In-First-Out)</li>\n          <li><strong>Annual Exclusion:</strong> R40,000 per year (not applied in calculations - to be claimed on ITR12)</li>\n        </ul>\n      </div>\n\n      <!-- Transaction Details -->\n      <div class=\"section\">\n        <h3>Transaction Details</h3>\n        <p class=\"sub-info\">Chronological listing of all cryptocurrency transactions with FIFO-based capital gains calculations</p>\n        \n        <table class=\"transaction-table\">\n          <thead>\n            <tr>\n              <th>Date</th>\n              <th>Type</th>\n              <th>Currency</th>\n              <th>Amount</th>\n              <th>Proceeds</th>\n              <th>Cost Base</th>\n              <th>Gain/Loss</th>\n              <th>Tax Year</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${transactions.map((tx, index) => {\n    var _tx$type;\n    return `\n              <tr>\n                <td>${formatDate(tx.date)}</td>\n                <td><span class=\"badge badge-${(_tx$type = tx.type) === null || _tx$type === void 0 ? void 0 : _tx$type.toLowerCase()}\">${tx.type}</span></td>\n                <td>${tx.currency}</td>\n                <td>${formatCrypto(tx.amount)}</td>\n                <td>${tx.proceeds !== null && tx.proceeds !== undefined ? formatCurrency(tx.proceeds) : '-'}</td>\n                <td>${tx.costBase !== null && tx.costBase !== undefined ? formatCurrency(tx.costBase) : '-'}</td>\n                <td class=\"${tx.capitalGain > 0 ? 'positive' : tx.capitalGain < 0 ? 'negative' : ''}\">\n                  ${tx.capitalGain !== null && tx.capitalGain !== undefined ? formatCurrency(tx.capitalGain) : '-'}\n                </td>\n                <td>${tx.taxYear || '-'}</td>\n              </tr>\n              ${tx.lotsConsumed && tx.lotsConsumed.length > 0 ? `\n                <tr class=\"fifo-detail\">\n                  <td colspan=\"8\">\n                    <div class=\"fifo-breakdown\">\n                      <strong>ðŸ“¦ FIFO Lots Consumed (${tx.lotsConsumed.length} lot${tx.lotsConsumed.length !== 1 ? 's' : ''}):</strong>\n                      <table class=\"fifo-table\">\n                        <thead>\n                          <tr>\n                            <th>Purchase Date</th>\n                            <th>Amount</th>\n                            <th>Cost/Unit</th>\n                            <th>Cost Base</th>\n                            <th>Held (Days)</th>\n                          </tr>\n                        </thead>\n                        <tbody>\n                          ${tx.lotsConsumed.map(lot => `\n                            <tr>\n                              <td>${formatDate(lot.purchaseDate)}</td>\n                              <td>${formatCrypto(lot.amountConsumed)}</td>\n                              <td>${formatCurrency(lot.costPerUnit)}</td>\n                              <td>${formatCurrency(lot.costBase)}</td>\n                              <td>${lot.ageInDays !== null && lot.ageInDays !== undefined ? `${lot.ageInDays}${lot.ageInDays >= 365 ? ' <span class=\"lt-badge\">LT</span>' : ''}` : '-'}</td>\n                            </tr>\n                          `).join('')}\n                        </tbody>\n                        <tfoot>\n                          <tr>\n                            <td colspan=\"3\"><strong>Total Cost Base:</strong></td>\n                            <td><strong>${formatCurrency(tx.lotsConsumed.reduce((sum, lot) => sum + lot.costBase, 0))}</strong></td>\n                            <td></td>\n                          </tr>\n                        </tfoot>\n                      </table>\n                      <p class=\"fifo-note\"><strong>FIFO Method:</strong> First-In-First-Out means the oldest coins purchased are sold first.</p>\n                    </div>\n                  </td>\n                </tr>\n              ` : ''}\n            `;\n  }).join('')}\n          </tbody>\n        </table>\n      </div>\n\n      <!-- Footer -->\n      <div class=\"report-footer\">\n        <p><strong>Disclaimer:</strong> This report is provided for informational purposes only and should not be considered as professional tax advice. \n        Please consult with a registered tax professional or chartered accountant before submitting your tax return to SARS.</p>\n        <p class=\"footer-note\">Generated by Crypto Tax Calculator â€¢ Powered by TaxTim</p>\n      </div>\n    </div>\n  `;\n};\nconst getPrintStyles = () => {\n  return `\n    @media print {\n      @page {\n        margin: 2cm;\n        size: A4;\n      }\n    }\n\n    * {\n      box-sizing: border-box;\n    }\n\n    body {\n      font-family: Arial, Helvetica, sans-serif;\n      line-height: 1.6;\n      color: #333;\n      max-width: 210mm;\n      margin: 0 auto;\n      padding: 20px;\n      background: white;\n    }\n\n    .report {\n      background: white;\n    }\n\n    .report-header {\n      text-align: center;\n      margin-bottom: 30px;\n      padding-bottom: 20px;\n      border-bottom: 3px solid #667eea;\n    }\n\n    .report-header h1 {\n      margin: 0 0 10px 0;\n      color: #2d3748;\n      font-size: 28px;\n    }\n\n    .report-header h2 {\n      margin: 0 0 10px 0;\n      color: #667eea;\n      font-size: 20px;\n      font-weight: normal;\n    }\n\n    .report-date {\n      margin: 10px 0;\n      color: #718096;\n      font-size: 14px;\n    }\n\n    .section {\n      margin-bottom: 30px;\n      page-break-inside: avoid;\n    }\n\n    .section h3 {\n      color: #2d3748;\n      font-size: 18px;\n      margin: 0 0 15px 0;\n      padding-bottom: 8px;\n      border-bottom: 2px solid #e2e8f0;\n    }\n\n    .sub-info {\n      color: #718096;\n      font-size: 13px;\n      margin-bottom: 15px;\n    }\n\n    .summary-table {\n      width: 100%;\n      border-collapse: collapse;\n      margin-bottom: 20px;\n    }\n\n    .summary-table td {\n      padding: 10px;\n      border-bottom: 1px solid #e2e8f0;\n    }\n\n    .summary-table .label {\n      width: 60%;\n      color: #4a5568;\n    }\n\n    .summary-table .value {\n      width: 40%;\n      text-align: right;\n      font-weight: 600;\n      color: #2d3748;\n    }\n\n    .summary-table .positive {\n      color: #38a169;\n    }\n\n    .summary-table .negative {\n      color: #e53e3e;\n    }\n\n    .summary-table .highlight {\n      background-color: #f7fafc;\n      font-size: 16px;\n    }\n\n    .summary-table .highlight-primary {\n      background-color: #ebf8ff;\n      font-size: 16px;\n    }\n\n    .info-box {\n      background: #f7fafc;\n      border-left: 4px solid #4299e1;\n      padding: 15px;\n      margin-top: 15px;\n    }\n\n    .info-box p {\n      margin: 5px 0;\n      font-size: 13px;\n      color: #4a5568;\n    }\n\n    ul {\n      margin: 10px 0;\n      padding-left: 25px;\n    }\n\n    li {\n      margin: 8px 0;\n      color: #4a5568;\n      font-size: 14px;\n    }\n\n    .transaction-table {\n      width: 100%;\n      border-collapse: collapse;\n      font-size: 11px;\n      margin-top: 15px;\n    }\n\n    .transaction-table thead {\n      background: #2d3748;\n      color: white;\n    }\n\n    .transaction-table th {\n      padding: 10px 8px;\n      text-align: left;\n      font-weight: 600;\n      font-size: 10px;\n      text-transform: uppercase;\n    }\n\n    .transaction-table tbody tr {\n      border-bottom: 1px solid #e2e8f0;\n    }\n\n    .transaction-table td {\n      padding: 8px;\n      color: #4a5568;\n    }\n\n    .badge {\n      display: inline-block;\n      padding: 3px 8px;\n      border-radius: 10px;\n      font-size: 9px;\n      font-weight: 600;\n      text-transform: uppercase;\n    }\n\n    .badge-buy {\n      background-color: #c6f6d5;\n      color: #22543d;\n    }\n\n    .badge-sell {\n      background-color: #fed7d7;\n      color: #742a2a;\n    }\n\n    .badge-trade, .badge-trade_sell, .badge-trade_buy {\n      background-color: #bee3f8;\n      color: #2c5282;\n    }\n\n    .fifo-detail td {\n      padding: 10px !important;\n      background-color: #fffaf0;\n    }\n\n    .fifo-breakdown {\n      font-size: 10px;\n    }\n\n    .fifo-table {\n      width: 100%;\n      margin-top: 10px;\n      font-size: 10px;\n    }\n\n    .fifo-table thead {\n      background: #4a5568;\n    }\n\n    .fifo-table th {\n      padding: 6px 8px;\n      font-size: 9px;\n    }\n\n    .fifo-table td {\n      padding: 5px 8px;\n    }\n\n    .report-footer {\n      margin-top: 40px;\n      padding-top: 20px;\n      border-top: 2px solid #e2e8f0;\n      font-size: 12px;\n      color: #718096;\n    }\n\n    .report-footer p {\n      margin: 10px 0;\n      line-height: 1.5;\n    }\n\n    .footer-note {\n      text-align: center;\n      font-weight: 600;\n      color: #4a5568;\n    }\n\n    @media print {\n      .section {\n        page-break-inside: avoid;\n      }\n      \n      .transaction-table {\n        page-break-inside: auto;\n      }\n      \n      .transaction-table tr {\n        page-break-inside: avoid;\n        page-break-after: auto;\n      }\n    }\n  `;\n};","map":{"version":3,"names":["generatePDF","transactions","summary","filters","reportHTML","generateReportHTML","printWindow","window","open","Error","document","write","getPrintStyles","close","setTimeout","print","formatCurrency","amount","Intl","NumberFormat","style","currency","minimumFractionDigits","maximumFractionDigits","format","formatCrypto","decimals","undefined","parseFloat","toFixed","replace","formatDate","dateString","date","Date","toLocaleDateString","year","month","day","hour","minute","currentDate","filterText","asset","push","type","taxYear","filterDisplay","length","join","totalCapitalGain","totalCapitalLoss","netCapitalGain","taxableCapitalGain","totalProceeds","totalCostBase","transactionsProcessed","map","tx","index","_tx$type","toLowerCase","proceeds","costBase","capitalGain","lotsConsumed","lot","purchaseDate","amountConsumed","costPerUnit","ageInDays","reduce","sum"],"sources":["C:/Users/Baloyi PA/Desktop/TaxTim-Team-6-New/TaxTim-Team-6-New/frontend/src/services/pdfGenerator.js"],"sourcesContent":["/**\r\n * PDF Generator for SARS Audit Report\r\n * \r\n * This module generates a comprehensive PDF audit report suitable for SARS submission.\r\n * Uses jsPDF library for PDF generation.\r\n */\r\n\r\n// For now, we'll create a simple implementation that uses the browser's print functionality\r\n// In production, you'd use jsPDF or similar library\r\n\r\nexport const generatePDF = async (transactions, summary, filters) => {\r\n  // Create a temporary container for the report\r\n  const reportHTML = generateReportHTML(transactions, summary, filters);\r\n  \r\n  // Create a new window for printing\r\n  const printWindow = window.open('', '_blank');\r\n  if (!printWindow) {\r\n    throw new Error('Popup blocked. Please allow popups for this site.');\r\n  }\r\n\r\n  printWindow.document.write(`\r\n    <!DOCTYPE html>\r\n    <html>\r\n    <head>\r\n      <title>Crypto Tax Audit Report - SARS</title>\r\n      <style>\r\n        ${getPrintStyles()}\r\n      </style>\r\n    </head>\r\n    <body>\r\n      ${reportHTML}\r\n    </body>\r\n    </html>\r\n  `);\r\n  \r\n  printWindow.document.close();\r\n  \r\n  // Wait for content to load, then print\r\n  setTimeout(() => {\r\n    printWindow.print();\r\n  }, 500);\r\n};\r\n\r\nconst generateReportHTML = (transactions, summary, filters) => {\r\n  const formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat('en-ZA', {\r\n      style: 'currency',\r\n      currency: 'ZAR',\r\n      minimumFractionDigits: 2,\r\n      maximumFractionDigits: 2,\r\n    }).format(amount);\r\n  };\r\n\r\n  const formatCrypto = (amount, decimals = 8) => {\r\n    if (amount === null || amount === undefined) return '-';\r\n    return parseFloat(amount).toFixed(decimals).replace(/\\.?0+$/, '');\r\n  };\r\n\r\n  const formatDate = (dateString) => {\r\n    if (!dateString) return '-';\r\n    const date = new Date(dateString);\r\n    return date.toLocaleDateString('en-ZA', {\r\n      year: 'numeric',\r\n      month: 'long',\r\n      day: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit'\r\n    });\r\n  };\r\n\r\n  const currentDate = new Date().toLocaleDateString('en-ZA', {\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: 'numeric'\r\n  });\r\n\r\n  const filterText = [];\r\n  if (filters.asset !== 'all') filterText.push(`Asset: ${filters.asset}`);\r\n  if (filters.type !== 'all') filterText.push(`Type: ${filters.type}`);\r\n  if (filters.taxYear !== 'all') filterText.push(`Tax Year: ${filters.taxYear}`);\r\n  const filterDisplay = filterText.length > 0 ? filterText.join(', ') : 'None';\r\n\r\n  return `\r\n    <div class=\"report\">\r\n      <!-- Header -->\r\n      <div class=\"report-header\">\r\n        <h1>Cryptocurrency Capital Gains Tax Report</h1>\r\n        <h2>SARS Audit Report</h2>\r\n        <p class=\"report-date\">Generated: ${currentDate}</p>\r\n        <div class=\"divider\"></div>\r\n      </div>\r\n\r\n      <!-- Executive Summary -->\r\n      <div class=\"section\">\r\n        <h3>Executive Summary</h3>\r\n        <table class=\"summary-table\">\r\n          <tr>\r\n            <td class=\"label\">Total Capital Gains:</td>\r\n            <td class=\"value positive\">${formatCurrency(summary.totalCapitalGain)}</td>\r\n          </tr>\r\n          <tr>\r\n            <td class=\"label\">Total Capital Losses:</td>\r\n            <td class=\"value negative\">${formatCurrency(summary.totalCapitalLoss)}</td>\r\n          </tr>\r\n          <tr class=\"highlight\">\r\n            <td class=\"label\"><strong>Net Capital Gain:</strong></td>\r\n            <td class=\"value\"><strong>${formatCurrency(summary.netCapitalGain)}</strong></td>\r\n          </tr>\r\n          <tr class=\"highlight-primary\">\r\n            <td class=\"label\"><strong>Taxable Capital Gain (40% inclusion):</strong></td>\r\n            <td class=\"value\"><strong>${formatCurrency(summary.taxableCapitalGain)}</strong></td>\r\n          </tr>\r\n          <tr>\r\n            <td class=\"label\">Total Proceeds:</td>\r\n            <td class=\"value\">${formatCurrency(summary.totalProceeds)}</td>\r\n          </tr>\r\n          <tr>\r\n            <td class=\"label\">Total Cost Base (FIFO):</td>\r\n            <td class=\"value\">${formatCurrency(summary.totalCostBase)}</td>\r\n          </tr>\r\n          <tr>\r\n            <td class=\"label\">Transactions Processed:</td>\r\n            <td class=\"value\">${summary.transactionsProcessed}</td>\r\n          </tr>\r\n        </table>\r\n        \r\n        <div class=\"info-box\">\r\n          <p><strong>Applied Filters:</strong> ${filterDisplay}</p>\r\n          <p><strong>Method:</strong> First-In-First-Out (FIFO)</p>\r\n          <p><strong>Inclusion Rate:</strong> 40% for individuals (as per SARS requirements)</p>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- SARS Compliance -->\r\n      <div class=\"section\">\r\n        <h3>SARS Compliance Information</h3>\r\n        <p>This report has been prepared in accordance with South African Revenue Service (SARS) guidelines for cryptocurrency taxation:</p>\r\n        <ul>\r\n          <li><strong>Tax Year:</strong> March 1 to February 28/29 of the following year</li>\r\n          <li><strong>CGT Inclusion Rate:</strong> 40% for individuals</li>\r\n          <li><strong>Valuation Method:</strong> FIFO (First-In-First-Out)</li>\r\n          <li><strong>Annual Exclusion:</strong> R40,000 per year (not applied in calculations - to be claimed on ITR12)</li>\r\n        </ul>\r\n      </div>\r\n\r\n      <!-- Transaction Details -->\r\n      <div class=\"section\">\r\n        <h3>Transaction Details</h3>\r\n        <p class=\"sub-info\">Chronological listing of all cryptocurrency transactions with FIFO-based capital gains calculations</p>\r\n        \r\n        <table class=\"transaction-table\">\r\n          <thead>\r\n            <tr>\r\n              <th>Date</th>\r\n              <th>Type</th>\r\n              <th>Currency</th>\r\n              <th>Amount</th>\r\n              <th>Proceeds</th>\r\n              <th>Cost Base</th>\r\n              <th>Gain/Loss</th>\r\n              <th>Tax Year</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            ${transactions.map((tx, index) => `\r\n              <tr>\r\n                <td>${formatDate(tx.date)}</td>\r\n                <td><span class=\"badge badge-${tx.type?.toLowerCase()}\">${tx.type}</span></td>\r\n                <td>${tx.currency}</td>\r\n                <td>${formatCrypto(tx.amount)}</td>\r\n                <td>${tx.proceeds !== null && tx.proceeds !== undefined ? formatCurrency(tx.proceeds) : '-'}</td>\r\n                <td>${tx.costBase !== null && tx.costBase !== undefined ? formatCurrency(tx.costBase) : '-'}</td>\r\n                <td class=\"${tx.capitalGain > 0 ? 'positive' : tx.capitalGain < 0 ? 'negative' : ''}\">\r\n                  ${tx.capitalGain !== null && tx.capitalGain !== undefined ? formatCurrency(tx.capitalGain) : '-'}\r\n                </td>\r\n                <td>${tx.taxYear || '-'}</td>\r\n              </tr>\r\n              ${tx.lotsConsumed && tx.lotsConsumed.length > 0 ? `\r\n                <tr class=\"fifo-detail\">\r\n                  <td colspan=\"8\">\r\n                    <div class=\"fifo-breakdown\">\r\n                      <strong>ðŸ“¦ FIFO Lots Consumed (${tx.lotsConsumed.length} lot${tx.lotsConsumed.length !== 1 ? 's' : ''}):</strong>\r\n                      <table class=\"fifo-table\">\r\n                        <thead>\r\n                          <tr>\r\n                            <th>Purchase Date</th>\r\n                            <th>Amount</th>\r\n                            <th>Cost/Unit</th>\r\n                            <th>Cost Base</th>\r\n                            <th>Held (Days)</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                          ${tx.lotsConsumed.map(lot => `\r\n                            <tr>\r\n                              <td>${formatDate(lot.purchaseDate)}</td>\r\n                              <td>${formatCrypto(lot.amountConsumed)}</td>\r\n                              <td>${formatCurrency(lot.costPerUnit)}</td>\r\n                              <td>${formatCurrency(lot.costBase)}</td>\r\n                              <td>${lot.ageInDays !== null && lot.ageInDays !== undefined ? \r\n                                `${lot.ageInDays}${lot.ageInDays >= 365 ? ' <span class=\"lt-badge\">LT</span>' : ''}` : \r\n                                '-'}</td>\r\n                            </tr>\r\n                          `).join('')}\r\n                        </tbody>\r\n                        <tfoot>\r\n                          <tr>\r\n                            <td colspan=\"3\"><strong>Total Cost Base:</strong></td>\r\n                            <td><strong>${formatCurrency(tx.lotsConsumed.reduce((sum, lot) => sum + lot.costBase, 0))}</strong></td>\r\n                            <td></td>\r\n                          </tr>\r\n                        </tfoot>\r\n                      </table>\r\n                      <p class=\"fifo-note\"><strong>FIFO Method:</strong> First-In-First-Out means the oldest coins purchased are sold first.</p>\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              ` : ''}\r\n            `).join('')}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      <!-- Footer -->\r\n      <div class=\"report-footer\">\r\n        <p><strong>Disclaimer:</strong> This report is provided for informational purposes only and should not be considered as professional tax advice. \r\n        Please consult with a registered tax professional or chartered accountant before submitting your tax return to SARS.</p>\r\n        <p class=\"footer-note\">Generated by Crypto Tax Calculator â€¢ Powered by TaxTim</p>\r\n      </div>\r\n    </div>\r\n  `;\r\n};\r\n\r\nconst getPrintStyles = () => {\r\n  return `\r\n    @media print {\r\n      @page {\r\n        margin: 2cm;\r\n        size: A4;\r\n      }\r\n    }\r\n\r\n    * {\r\n      box-sizing: border-box;\r\n    }\r\n\r\n    body {\r\n      font-family: Arial, Helvetica, sans-serif;\r\n      line-height: 1.6;\r\n      color: #333;\r\n      max-width: 210mm;\r\n      margin: 0 auto;\r\n      padding: 20px;\r\n      background: white;\r\n    }\r\n\r\n    .report {\r\n      background: white;\r\n    }\r\n\r\n    .report-header {\r\n      text-align: center;\r\n      margin-bottom: 30px;\r\n      padding-bottom: 20px;\r\n      border-bottom: 3px solid #667eea;\r\n    }\r\n\r\n    .report-header h1 {\r\n      margin: 0 0 10px 0;\r\n      color: #2d3748;\r\n      font-size: 28px;\r\n    }\r\n\r\n    .report-header h2 {\r\n      margin: 0 0 10px 0;\r\n      color: #667eea;\r\n      font-size: 20px;\r\n      font-weight: normal;\r\n    }\r\n\r\n    .report-date {\r\n      margin: 10px 0;\r\n      color: #718096;\r\n      font-size: 14px;\r\n    }\r\n\r\n    .section {\r\n      margin-bottom: 30px;\r\n      page-break-inside: avoid;\r\n    }\r\n\r\n    .section h3 {\r\n      color: #2d3748;\r\n      font-size: 18px;\r\n      margin: 0 0 15px 0;\r\n      padding-bottom: 8px;\r\n      border-bottom: 2px solid #e2e8f0;\r\n    }\r\n\r\n    .sub-info {\r\n      color: #718096;\r\n      font-size: 13px;\r\n      margin-bottom: 15px;\r\n    }\r\n\r\n    .summary-table {\r\n      width: 100%;\r\n      border-collapse: collapse;\r\n      margin-bottom: 20px;\r\n    }\r\n\r\n    .summary-table td {\r\n      padding: 10px;\r\n      border-bottom: 1px solid #e2e8f0;\r\n    }\r\n\r\n    .summary-table .label {\r\n      width: 60%;\r\n      color: #4a5568;\r\n    }\r\n\r\n    .summary-table .value {\r\n      width: 40%;\r\n      text-align: right;\r\n      font-weight: 600;\r\n      color: #2d3748;\r\n    }\r\n\r\n    .summary-table .positive {\r\n      color: #38a169;\r\n    }\r\n\r\n    .summary-table .negative {\r\n      color: #e53e3e;\r\n    }\r\n\r\n    .summary-table .highlight {\r\n      background-color: #f7fafc;\r\n      font-size: 16px;\r\n    }\r\n\r\n    .summary-table .highlight-primary {\r\n      background-color: #ebf8ff;\r\n      font-size: 16px;\r\n    }\r\n\r\n    .info-box {\r\n      background: #f7fafc;\r\n      border-left: 4px solid #4299e1;\r\n      padding: 15px;\r\n      margin-top: 15px;\r\n    }\r\n\r\n    .info-box p {\r\n      margin: 5px 0;\r\n      font-size: 13px;\r\n      color: #4a5568;\r\n    }\r\n\r\n    ul {\r\n      margin: 10px 0;\r\n      padding-left: 25px;\r\n    }\r\n\r\n    li {\r\n      margin: 8px 0;\r\n      color: #4a5568;\r\n      font-size: 14px;\r\n    }\r\n\r\n    .transaction-table {\r\n      width: 100%;\r\n      border-collapse: collapse;\r\n      font-size: 11px;\r\n      margin-top: 15px;\r\n    }\r\n\r\n    .transaction-table thead {\r\n      background: #2d3748;\r\n      color: white;\r\n    }\r\n\r\n    .transaction-table th {\r\n      padding: 10px 8px;\r\n      text-align: left;\r\n      font-weight: 600;\r\n      font-size: 10px;\r\n      text-transform: uppercase;\r\n    }\r\n\r\n    .transaction-table tbody tr {\r\n      border-bottom: 1px solid #e2e8f0;\r\n    }\r\n\r\n    .transaction-table td {\r\n      padding: 8px;\r\n      color: #4a5568;\r\n    }\r\n\r\n    .badge {\r\n      display: inline-block;\r\n      padding: 3px 8px;\r\n      border-radius: 10px;\r\n      font-size: 9px;\r\n      font-weight: 600;\r\n      text-transform: uppercase;\r\n    }\r\n\r\n    .badge-buy {\r\n      background-color: #c6f6d5;\r\n      color: #22543d;\r\n    }\r\n\r\n    .badge-sell {\r\n      background-color: #fed7d7;\r\n      color: #742a2a;\r\n    }\r\n\r\n    .badge-trade, .badge-trade_sell, .badge-trade_buy {\r\n      background-color: #bee3f8;\r\n      color: #2c5282;\r\n    }\r\n\r\n    .fifo-detail td {\r\n      padding: 10px !important;\r\n      background-color: #fffaf0;\r\n    }\r\n\r\n    .fifo-breakdown {\r\n      font-size: 10px;\r\n    }\r\n\r\n    .fifo-table {\r\n      width: 100%;\r\n      margin-top: 10px;\r\n      font-size: 10px;\r\n    }\r\n\r\n    .fifo-table thead {\r\n      background: #4a5568;\r\n    }\r\n\r\n    .fifo-table th {\r\n      padding: 6px 8px;\r\n      font-size: 9px;\r\n    }\r\n\r\n    .fifo-table td {\r\n      padding: 5px 8px;\r\n    }\r\n\r\n    .report-footer {\r\n      margin-top: 40px;\r\n      padding-top: 20px;\r\n      border-top: 2px solid #e2e8f0;\r\n      font-size: 12px;\r\n      color: #718096;\r\n    }\r\n\r\n    .report-footer p {\r\n      margin: 10px 0;\r\n      line-height: 1.5;\r\n    }\r\n\r\n    .footer-note {\r\n      text-align: center;\r\n      font-weight: 600;\r\n      color: #4a5568;\r\n    }\r\n\r\n    @media print {\r\n      .section {\r\n        page-break-inside: avoid;\r\n      }\r\n      \r\n      .transaction-table {\r\n        page-break-inside: auto;\r\n      }\r\n      \r\n      .transaction-table tr {\r\n        page-break-inside: avoid;\r\n        page-break-after: auto;\r\n      }\r\n    }\r\n  `;\r\n};\r\n"],"mappings":"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;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}